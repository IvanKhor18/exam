let questions = [];
let currentQuestionIndex = 0;
let userAnswers = [];

// Fetch and render the questions from the JSON
async function fetchQuestions() {
    const response = await fetch('questions.json');
    questions = await response.json();
    renderQuestion();
}

function renderQuestion() {
    const questionElement = document.getElementById('question-title');
    const questionNumberElement = document.getElementById('question-number');
    const answersContainer = document.getElementById('question-container');
    const showAnswerContainer = document.getElementById('show-answer');

    const currentQuestion = questions[currentQuestionIndex];
    questionElement.innerText = currentQuestion.question; // Update question text
    questionNumberElement.innerText = `Question ${currentQuestionIndex + 1} of ${questions.length}`; // Update question number
    answersContainer.innerHTML = ''; // Clear previous answers
    showAnswerContainer.innerHTML = ''; // Clear previous answers feedback

    currentQuestion.answers.forEach(answer => {
        const answerElement = document.createElement('div');
        answerElement.className = 'answer';
        answerElement.innerHTML = `
            <input type="${currentQuestion.answerType === 'single' ? 'radio' : 'checkbox'}" name="answer" value="${answer.id}" onchange="handleAnswerSelection(${answer.id})">
            <label>${answer.text}</label>
        `;
        answersContainer.appendChild(answerElement);
    });
}

document.getElementById('reset-button').onclick = () => {
    currentQuestionIndex = 0; // Reset to first question
    renderQuestion();
    userAnswers = {}; // Clear previous answers
};

document.getElementById('randomize-button').onclick = () => {
    questions.sort(() => Math.random() - 0.5); // Randomize the questions
    currentQuestionIndex = 0; // Reset to the first question after randomization
    renderQuestion();
};

document.getElementById('submit-button').onclick = handleSubmit;
document.getElementById('previous-button').onclick = () => {
    if (currentQuestionIndex > 0) {
        currentQuestionIndex--;
        renderQuestion();
    }
};
document.getElementById('next-button').onclick = () => {
    if (currentQuestionIndex < questions.length - 1) {
        currentQuestionIndex++;
        renderQuestion();
    }
    // Clear the previous answer feedback when moving to the next question
    document.getElementById('show-answer').innerHTML = '';
};

fetchQuestions(); // Start fetching questions on page load
